This module focuses on observability, detection, and automation.

| Concept | Key Details & Objectives | Sources |
| :--- | :--- | :--- |
| **Security Sensors** | Collect information from hosts or networks [64]. **Host sensors** include EDR software and OS event logs [65, 66]. **Network sensors** include Network Taps/SPAN ports and IDS/IPS [65, 67]. | [64, 65] |
| **Logging Importance** | Logs are critical for identifying security issues (port scans, brute force, account compromise) and providing historical/forensic data [68, 69]. | [68, 69] |
| **Centralized Logging** | Crucial component of secure architecture [70, 71]. Aggregating all logs to a single destination (e.g., SIEM or Syslog server) eases auditing, enables correlation, and protects logs from deletion by attackers [70, 72, 73]. | [70-72] |
| **Log Formats** | Logging systems utilize standardized formats such as **Syslog** [74], **JSON** [74], and **CEF (Common Event Format)** [75]. **Normalization** is the process where centralized systems convert various formats into a standard, readable structure [76, 77]. | [74, 75, 77] |
| **Analysis & Automation** | **SIEM (Security Information & Event Management)** systems ingest and normalize logs, performing real-time analysis and correlation (the "brain" of the centralized structure) [76, 78]. **SOAR (Security Orchestration, Automation, & Response)** platforms automate security responses, such as blocking IPs or disabling accounts based on SIEM alerts [79, 80]. | [76, 78-80] |
| **Log Management** | Log storage requires tiered planning (fast storage for active logs, cheaper for archives) [81]. **Retention** periods are based on compliance and organizational needs [82]. Logs should be protected from unauthorized viewing, modification, or deletion [45]. | [45, 81, 82] |

Proper logging is critical for identifying threats like port scans, brute force attacks, and account compromises, and for providing historical forensic data.

| Technical Domain | Key Concepts & Implementations | Sources |
| :--- | :--- | :--- |
| **Sensors** | **Host Sensors** include EDR (Endpoint Detection & Response) software, HIDS/HIPS, and Windows Event logs (Security, Application, System). **Network Sensors** include Network Taps (dedicated copying of traffic) and **SPAN (Switched Port Analyzer) or Mirror Ports** (copying traffic on a network device, which can drop packets). | |
| **Centralized Logging** | Centralization is a **critical piece of secure infrastructure**. It enables automation, correlated analysis, and protects logs from attackers who frequently delete them to cover their tracks. Delivery methods include **Push** (Syslog, HTTP API) or **Pull**. **NTP (Network Time Protocol)** synchronization is required for accurate timestamps across all devices. | |
| **Formats & Normalization** | Logs are standardized into formats such as **Syslog**, **JSON** (JavaScript Object Notation, easily parsed by languages), and **CEF (Common Event Format)** (developed by ArcSight). **Normalization** is the process where centralized systems convert varied inputs into a standard structure. | |
| **SIEM & SOAR** | **SIEM (Security Information & Event Management)** is the "brain," ingesting and normalizing logs to perform **real-time correlation** and analysis. **SOAR (Security Orchestration, Automation, & Response)** platforms automate security workflows (e.g., blocking malicious IPs on firewalls based on SIEM alerts). Automated analysis requires multiple log sources (login systems, security appliances, public systems) for accurate intelligence. | |
| **Log Management** | Retention periods are based on compliance and organizational risk appetite. To calculate storage: (Daily Log Size) * (Required Retention Days) = Total Storage (e.g., 11GB/day logs for 365 days = 4TB total storage). **Log filtering** (based on Event IDs or keywords) helps reduce log bloat. | |

This module emphasizes the critical role of observability in enterprise defense, focusing on the deployment of security sensors, the implementation of centralized logging, and the use of automated analysis tools like SIEM and SOAR to detect and respond to threats in near real-time. Proper logging provides historical and forensic data essential for accountability and incident response.

## 1. Security Sensor Fundamentals

Security sensors are devices or configurations that **collect information about the network or device** to assist in analyzing security data and events. There is no single sensor that captures everything, necessitating a complete system that logs every meaningful event, ideally without redundancy.

### Sensor Types and Placement

| Sensor Type | Description and Function | Key Implementations | Sources |
| :--- | :--- | :--- | :--- |
| **Host Sensors** | Part of (or installed on) a specific host or device. Logs from the OS or installed applications. | **Windows Event logs** (Security, Application, System), **EDR/AV agents** (monitor malicious files/processes), **HIDS/HIPS** (Host-based Intrusion Detection/Prevention, monitoring local network traffic), and application/service logs (HTTP, SMTP, database). | |
| **Network Sensors** | Devices or configurations that provide data on network traffic. Placement determines which traffic is logged. | **Network Tap** (standalone device that copies traffic to a monitoring port) and **Port Mirroring/SPAN** (a configuration on a network device that copies all traffic to a mirror port, though it can affect performance and drop packets). | |
| **Service Sensors** | Generated from specific applications or services (e.g., HTTP, SMTP). | Can assist in identifying brute-force attempts and attacks against web servers. | |

### Handling Encrypted Traffic

Encrypted network traffic (e.g., SSL/TLS) is difficult to monitor because the contents cannot be read. Monitoring options include:

*   Analyzing **source and destination information** to identify traffic going to known malicious destinations.
*   Using an **SSL/TLS proxy** to decrypt, read, re-encrypt, and send traffic to its destination, though this increases complexity and errors.

---

## 2. Centralized Logging Architecture

Centralized logging is a **critical piece of any secure infrastructure**. It involves sending all logs from various generating systems to one (or multiple) destinations, typically viewed through a single dashboard.

### Benefits of Centralization

*   **Automation and Alerting:** Enables systems to look at all logs and use **event correlation** to determine malicious activity.
*   **Protection:** **Increases difficulty for attackers altering/deleting logs**. Offloaded logs are protected from attackers who frequently delete logs to cover their tracks.
*   **Simplified Auditing:** Comparing 1,000 separate endpoints to 1 central dashboard significantly eases auditing and monitoring.

### Logging Configuration and Delivery

*   **Time Synchronization:** **NTP (Network Time Protocol)** synchronization is essential to ensure consistent dates and times across all systems for accurate correlation.
*   **Log Filtering:** Filtering unnecessary data (e.g., by **Event IDs** or **Keywords**) helps reduce **"log bloat"**, which minimizes storage requirements and costs.
*   **Delivery Methods:**
    *   **Push:** Source system sends logs to a central server (e.g., **Syslog**, FTP, HTTP API).
    *   **Pull:** Log server connects to the source and downloads logs.
    *   **Agent:** An agent installed on the source device sends logs to the server.
*   **Continuous Delivery:** Logs are immediately sent as generated, used for critical systems (e.g., public web servers, firewalls, authentication servers) to enable near real-time identification of potential issues.

### Log Formats and Normalization

Logs come from multiple sources in various formats. Centralized logging systems address this through standardization:

*   **Normalization:** The process where centralized logging systems (like SIEM) **ingest and convert different log formats into a standard, easier-to-read structure**.
*   **Standard Formats:** Commonly used formats include **Syslog** (header, structured-data, message), **JSON (JavaScript Object Notation)** (parsed by nearly all programming languages), and **CEF (Common Event Format)** (developed by ArcSight, simpler than JSON, used across multiple vendors).

---

## 3. Automated Analysis, SIEM, and SOAR

Automated analysis is crucial for managing large data sets and detecting complex threats using correlation.

| System/Method | Function and Purpose | Sources |
| :--- | :--- | :--- |
| **SIEM** (Security Information & Event Management) | The "brain" of the centralized logging structure, providing **real-time analysis and correlation**. It ingests, normalizes logs, and can generate alerts or take automated actions. Detects activities like brute force attacks, impossible travel, and unauthorized file changes. | |
| **SOAR** (Security Orchestration, Automation, & Response) | Allows organizations to **automate security-related tasks and streamline security operations**. It collects inputs (often from SIEM) and coordinates automated management across multiple security tools (orchestration) to accomplish security objectives. | |
| **Alerting** | Alerts should be finely tuned to avoid **"alert fatigue"** (receiving too many false positives), which can lead analysts to discard or ignore legitimate events. Near real-time alerting requires continuous log delivery. | |
| **Manual Review** | Used in conjunction with automated analysis, especially during active incidents, to perform deep dives and catch events automated systems might miss. It requires viewing raw logs, which bypasses filtering, but is slower than automated analysis. | |

---

## 4. Log Storage and Retention

Proper planning for storage and retention is mandatory, driven by compliance and operational needs.

*   **Retention Factors:** Logs must be kept as long as necessary, governed by **regulations and compliance requirements** (varying by industry) and organizational needs (e.g., history of incidents).
*   **Storage Calculation:** Determine required storage by multiplying the daily log size by the required retention days. Example: 11 GB/day for 365 days requires 4 TB of total storage.
*   **Storage Tiers:** Log storage should utilize multiple tiers: **fast storage for active logs** and **cheaper storage for archives**.
*   **Protection:** Logs must be protected from unauthorized **viewing, modification, or deletion**. Backups should be read-only, and **offline backups are ideal** for long-term retention of critical data as they are not accessible over the network.

---
**Analogy for Centralized Logging (SIEM/SOAR):**

Centralized logging is like a company installing security cameras and sensors everywhere—not just on the doors (firewalls), but on the internal desks (endpoints), file cabinets (servers), and phones (applications). The **SIEM** acts as the main security guard in the control room: it watches all those feeds simultaneously, normalizes the information into a single timeline, and uses correlation rules to spot a problem instantly (e.g., an employee logged in from an unusual IP, then accessed a sensitive file, then attempted to email it out—all coordinated events). The **SOAR** system is the guard's automated response system, automatically dispatching security (blocking the IP and disabling the account) as soon as the SIEM raises the alarm.